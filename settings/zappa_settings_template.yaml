# Inputs
# region
# queue_name_prefix, e.g., Moonunit-InboundResponses
# username, e.g., rcollimore (only used for dev deploy)
# resource_suffix, e.g., dev-rcollimore, sandbox

base_stage:
  project_name: Moonunit-Webhook
  aws_environment_variables:
    STACK_NAME: {stack_name}
    BUCKET_NAME: {bucket_name}
  debug: true
  log_level: DEBUG
  apigateway_description: Moonunit API Endpoint to write files to S3
  lambda_description: Moonunit lambda handler
  app_function: moonunit.ingress_handler.app
  aws_region: {region}
  profile_name: default
  runtime: python3.6
  s3_bucket: moonunitllc-{region}-zappa-staging
  timeout_seconds: 15
  memory_size: 128
  attach_policy: tmp/attach_policy.json
  events:
  - function: moonunit.s3_put_handler
    event_source:
      arn:  arn:aws:s3:::moonunitllc-source-test-us-east-2 # TODO
      events:
        - s3:ObjectCreated:*

dev_{username}:
  extends: base_stage
  domain: moonunit-webhook-{resource_suffix}.doorwall.haus

  # cert is only in us-east-1, so hardcoded. cert is on *.example.org, so shared
  certificate_arn: arn:aws:acm:us-east-1:XXXXXXXXXXXXXX:certificate/XXXX-XXXX-XXXX-XXXX

sandbox:
  extends: base_stage
  domain: moonunit-webhook-sandbox.example.org
  certificate_arn: arn:aws:acm:us-east-1:XXXXXXXXXXXXXX:certificate/XXXX-XXXX-XXXX-XXXX

qa:
  extends: base_stage
  domain: moonunit-webhook-qa.example.org
  certificate_arn: arn:aws:acm:us-east-1:XXXXXXXXXXXXXX:certificate/XXXX-XXXX-XXXX-XXXX

production:
  extends: base_stage
  domain: moonunit-webhook.example.com
  certificate_arn: arn:aws:acm:us-east-1:XXXXXXXXXXXXXX:certificate/XXXX-XXXX-XXXX-XXXX
